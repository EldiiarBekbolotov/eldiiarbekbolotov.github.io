<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FLRPR7R7LT"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-FLRPR7R7LT');
    </script>
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
    <link rel=icon type=image/png sizes=32x32 href=favicon-32x32.png>
    <link rel=icon type=image/png sizes=16x16 href=favicon-16x16.png>
    <link rel="manifest" href="site.webmanifest" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="description"
        content="Eldiiar Bekbolotov is an entrepreneur, software engineer, and high school student, currently based in Ottawa." />
    <meta property="og:image" content="apple-touch-icon.png" />
    <meta property="og:description"
        content="Eldiiar Bekbolotov is an entrepreneur, software engineer, and high school student, currently based in Ottawa." />
    <meta property="og:title" content="Eldiiar Bekbolotov" />
    <title>Eldiiar Bekbolotov</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto+Flex:opsz,wght@8..144,100..1000&family=Roboto+Mono:ital,wght@0,100..700;1,100..700&family=Roboto+Serif:ital,opsz,wght@0,8..144,100..900;1,8..144,100..900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="css/main.css">
    <!-- Include a lightweight markdown renderer -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        * {
            --primary2: var(--primary);
            --primary-color2: var(--primary-color);
            --primary-hover2: var(--primary-hover);

            --primary2: rgb(208, 136, 77);
            --primary-color2: #000000bc;
            --primary-hover2: rgb(254, 176, 112);
        }

        html,
        body {
            background: #000e12;
            color: #FFF;
            height: 100%;
            font-family: var(--small-font);
        }

        a {
            color: var(--primary-hover2);
        }

        a:hover {
            color: var(--primary2);
        }

        #chat-messages::-webkit-scrollbar {
            width: 8px;
        }

        #chat-messages::-webkit-scrollbar-track {
            background: #1a1a1a;
            border-radius: 4px;
        }

        #chat-messages::-webkit-scrollbar-thumb {
            background: #555;
            border-radius: 4px;
        }

        #chat-messages::-webkit-scrollbar-thumb:hover {
            background: #888;
        }

        #chat-messages {
            scrollbar-width: thin;
            scrollbar-color: #555 #1a1a1a;
        }

        .chat-container {
            background: transparent;

            max-width: 760px;
            display: flex;
            width: 80vw;
            height: calc(100% - 80px);
            flex-direction: column;
            overflow: hidden;
        }

        #chat-messages {
            flex: 1;
            padding: 15px;
            padding-bottom: 150px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            overflow-y: auto;
        }

        .message {
            padding: 10px 15px;
            border-radius: 15px;
            font-family: var(--small-font);
            color: rgba(255, 255, 255, 0.7);
            font-size: 16px;
            font-weight: 400;
            max-width: 80%;
            word-wrap: break-word;
            overflow-wrap: anywhere;
        }

        .message.assistant {

            max-width: 100%;
        }

        .message pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-wrap: anywhere;
            max-width: 100%;
            background: rgba(255, 255, 255, 0.08);
            padding: 8px 12px;
            border-radius: 10px;
            font-family: 'Roboto Mono', monospace;
            font-size: 14px;
        }

        .message p {
            font-size: inherit;
            font-weight: 400;
        }

        li {
            font-size: inherit;
            color: inherit;
        }

        .user {
            align-self: flex-end;
            background: var(--primary2);
            border-radius: 24px 4px 24px 24px;
            padding: 12px;
        }

        .user p {
            color: var(--primary-color2) !important;

            padding: 0px;
            margin: 0;
        }

        .assistant {
            align-self: flex-start;
            background: transparent;
            border-radius: 24px 24px 24px 4px;
            padding: 0 12px;
        }

        .message-wrapper.assistant {
            display: flex;
            flex-direction: column;
            align-self: flex-start;
            max-width: 100%;
            gap: 6px;
        }

        .copy-btn {
            align-self: flex-start;
            width: 32px;
            height: 32px;
            padding: 0;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s, color 0.2s;
        }

        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
        }

        .copy-btn:active {
            transform: scale(0.95);
        }

        .copy-btn svg {
            width: 18px;
            height: 18px;
        }

        .copy-btn.copied {
            color: #4ade80;
            background: rgba(74, 222, 128, 0.15);
        }

        .input-container {
            width: 100%;
            display: flex;
            flex-direction: column;
            background: #222;
            border-radius: 12px;
            overflow: hidden;
            min-height: 120px;
            position: relative;
        }

        #chat-input {
            flex: 1;
            min-height: 72px;
            max-height: 200px;
            padding: 12px 16px 8px 16px;
            border: none;
            outline: none;
            background: transparent;
            color: white;
            font-size: 16px;
            font-family: var(--small-font);
            border-radius: 0;
            resize: none;
            overflow-y: auto;
            line-height: 1.4;
            box-sizing: border-box;
        }

        #send-btn {
            padding: 0 20px;
            border: none;
            border-radius: 0 0 12px 12px;
            background: var(--primary2);
            color: white;
            font-family: var(--small-font);
            font-weight: 400;
            cursor: pointer;
            height: 48px;
            align-self: stretch;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s, opacity 0.2s;
        }

        /* Desktop: circle button bottom-right inside input area */
        @media only screen and (min-width: 601px) {
            .input-container {
                flex-direction: row;
                align-items: flex-end;
                min-height: 72px;
            }

            #chat-input {
                padding-right: 64px;
                padding-bottom: 12px;
                border-radius: 12px 0 0 12px;
            }

            #send-btn {
                position: absolute;
                right: 8px;
                bottom: 8px;
                width: 48px;
                height: 48px;
                min-width: 48px;
                min-height: 48px;
                padding: 0;
                border-radius: 50%;
                align-self: auto;
            }
        }

        #send-btn:hover {
            background: var(--primary-hover2);
        }

        /* Disabled state styling */
        #send-btn:disabled {
            background: #555;
            color: rgba(255, 255, 255, 0.5);
            cursor: not-allowed;
            opacity: 1;
        }

        #send-btn:disabled svg {
            fill: rgba(255, 255, 255, 0.5);
        }


        .typing {
            font-style: italic;
            opacity: 0.7;
        }

        #back {
            position: fixed;
            left: 2px;
            top: 2px;
            height: 72px;
            width: 72px;
            line-height: 72px;
            transform: scale(0.7);
            display: flex;
            text-align: center;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            border-radius: 100px;
            background-color: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            max-width: 1000px;
            margin: 0 auto;
            mix-blend-mode: difference;
        }

        @media only screen and (max-width: 480px) {}

        @media only screen and (max-width: 600px) {
            .input-container {
                border-radius: 0;
                flex-direction: column;
                min-height: 120px;
            }

            #chat-input {
                padding-right: 16px;
                padding-bottom: 8px;
                border-radius: 0;
            }

            #send-btn {
                position: static;
                width: auto;
                height: 48px;
                min-width: auto;
                min-height: 48px;
                border-radius: 0 0 0 0;
                align-self: stretch;
            }
        }

        @media only screen and (min-width: 481px) and (max-width: 1024px) {


            .chat-container {
                width: 90vw;
            }
        }

        @media only screen and (min-width: 1000px) {


            .chat-container {
                width: 80vw;
            }
        }

        #social-links {
            border-top-left-radius: 0px;
            border-top-right-radius: 0px;
            border-bottom-left-radius: 10px;

            border-bottom-right-radius: 10px;
        }
    </style>
</head>

<body>

    <div id="social-links" style="top:0;">
        <div id="back">
            <a href="\index.html" class="social-link" style="font-size: 16px;margin:0;">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                    fill="#FFFFFF" style="margin:0;padding:0;margin-left:-4px;margin-top:-4px;">
                    <path
                        d="m382-480 294 294q15 15 14.5 35T675-116q-15 15-35 15t-35-15L297-423q-12-12-18-27t-6-30q0-15 6-30t18-27l308-308q15-15 35.5-14.5T676-844q15 15 15 35t-15 35L382-480Z" />
                </svg>
            </a>
        </div>
        <img src="android-chrome-512x512.png" style="border-radius:50%;width:40px;height:40px;margin-right:15px;">
        <h1 style="font-size:19px;font-family:var(--big-font);font-weight:400;" class="no-select">Eldiiar Bekbolotov</h1>
    </div>
    <div class="bottom-area"
        style="position:fixed;bottom:0;left:0;right:0;z-index:1000;display:flex;justify-content:center;background:transparent;padding:0 20px 10px 20px;">
        <div class="input-container" style="width:100%;max-width:1000px;margin:0 auto;">
            <textarea id="chat-input" placeholder="Message" autocomplete="off" rows="1"></textarea>
            <button id="send-btn"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960"
                    width="24px" fill="#000000">
                    <path
                        d="M792-443 176-183q-20 8-38-3.5T120-220v-520q0-22 18-33.5t38-3.5l616 260q25 11 25 37t-25 37ZM200-280l474-200-474-200v140l240 60-240 60v140Zm0 0v-400 400Z" />
                </svg></button>
        </div>
    </div>
    <div style="justify-content:center;display:flex;height:100%;">
        <div class="chat-container">
            <div id="chat-messages" style="padding-top:100px;">

            </div>
        </div>
    </div>

    <script>
        const chatMessages = document.getElementById('chat-messages');
        const chatInput = document.getElementById('chat-input');
        const sendBtn = document.getElementById('send-btn');
        const STORAGE_KEY = 'eldiiarGPTChat';

        let messages = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];

        const copyIconSvg = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>';
        const checkIconSvg = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>';

        function renderMessages() {
            chatMessages.innerHTML = '';
            messages.forEach(msg => {
                if (msg.role === 'assistant') {
                    const wrapper = document.createElement('div');
                    wrapper.classList.add('message-wrapper', 'assistant');
                    const div = document.createElement('div');
                    div.classList.add('message', 'assistant');
                    div.innerHTML = marked.parse(msg.content);
                    const copyBtn = document.createElement('button');
                    copyBtn.type = 'button';
                    copyBtn.className = 'copy-btn';
                    copyBtn.title = 'Copy';
                    copyBtn.setAttribute('aria-label', 'Copy response');
                    copyBtn.innerHTML = copyIconSvg;
                    copyBtn.addEventListener('click', () => {
                        navigator.clipboard.writeText(msg.content).then(() => {
                            copyBtn.innerHTML = checkIconSvg;
                            copyBtn.title = 'Copied!';
                            copyBtn.classList.add('copied');
                            copyBtn.setAttribute('aria-label', 'Copied');
                            setTimeout(() => {
                                copyBtn.innerHTML = copyIconSvg;
                                copyBtn.title = 'Copy';
                                copyBtn.classList.remove('copied');
                                copyBtn.setAttribute('aria-label', 'Copy response');
                            }, 2000);
                        }).catch(() => {});
                    });
                    wrapper.appendChild(div);
                    wrapper.appendChild(copyBtn);
                    chatMessages.appendChild(wrapper);
                } else {
                    const div = document.createElement('div');
                    div.classList.add('message', msg.role);
                    div.innerHTML = marked.parse(msg.content);
                    chatMessages.appendChild(div);
                }
            });
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        const INPUT_MAX_HEIGHT = 200;

        function growInput() {
            chatInput.style.height = 'auto';
            chatInput.style.height = Math.min(chatInput.scrollHeight, INPUT_MAX_HEIGHT) + 'px';
        }

        function resetInputHeight() {
            chatInput.style.height = 'auto';
        }

        async function sendMessage(content) {
            if (!content.trim()) return;

            messages.push({ role: 'user', content });
            trimMessages();
            renderMessages();
            chatInput.value = '';
            resetInputHeight();

            const typingDiv = document.createElement('div');
            typingDiv.classList.add('message', 'assistant', 'typing');
            typingDiv.textContent = 'EldiiarGPT is typing...';
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            try {
                const res = await fetch('https://eldiiar.netlify.app/.netlify/functions/chatWithGroq', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ messages })
                });
                const data = await res.json();
                const botReply = data.reply || 'No response';

                typingDiv.remove();
                messages.push({ role: 'assistant', content: botReply });
                trimMessages();
                renderMessages();
                saveMessages();
            } catch (err) {
                console.error(err);
                typingDiv.remove();
                messages.push({ role: 'assistant', content: 'Error: Could not reach AI' });
                trimMessages();
                renderMessages();
                saveMessages();
            }
        }

        function trimMessages() {
            if (messages.length > 25) messages = messages.slice(-25);
        }

        function saveMessages() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(messages));
        }

        // Event listeners
        sendBtn.addEventListener('click', () => {
            sendMessage(chatInput.value);
            sendBtn.disabled = true;
        });

        chatInput.addEventListener('input', () => {
            sendBtn.disabled = !chatInput.value.trim();
            growInput();
        });

        chatInput.addEventListener('keydown', e => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
            }
        });

        sendBtn.disabled = !chatInput.value.trim();

        renderMessages();
    </script>
</body>

</html>